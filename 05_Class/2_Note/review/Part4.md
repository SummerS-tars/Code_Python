# Part 4 程序级别进阶部分

## 1. 课件8：标准模块应用

核心在于模块化，以减少重复工作  

### 1.1. 基础：模块的导入与使用

模块：包含函数、类和变量的文件。  
简单来说就是一个`.py`文件。  

为什么要使用模块？  

- 代码重用：避免重复编写相同代码。  
- 减少运行压力：按需加载功能。  
- 组织代码：提高代码可读性和维护性。

#### 1.1.1. 导入方式

1. **导入整个模块**  

   ```python
   import module_name
   ```

2. **从模块中导入特定内容**  

   ```python
   from module_name import function_name
   ```

   可以导入多个，以及可以用as起别名：  

3. **导入模块并指定别名**  

   ```python
   import module_name as alias
   ```

### 1.2. 示例模块介绍

以下介绍几个常用的标准模块：  

- `random`  
- `math`  
- `string`
- `re`

#### 1.2.1. random模块

用于生成伪随机数和处理随机样本  

常用函数：  

- random()：返回 [0,1) 区间的随机浮点数。
- randint(a, b)：返回 [a,b] 区间的随机整数。
- choice(seq)：从序列中随机返回一个元素。
- sample(seq, n)：从序列中随机选择 n 个不重复的元素。
- shuffle(list)：原地打乱列表顺序。

#### 1.2.2. math模块

提供数学常量和实数运算函数，不支持复数  

- 数论函数：
    - comb(n, k)（组合数）
    - perm(n, k)（排列数）
    - factorial(n)（阶乘）
    - gcd(a, b)（最大公约数）。
- 取整与绝对值：
    - ceil(x)（向上取整）
    - floor(x)（向下取整）
    - fabs(x)（浮点绝对值）。
- 幂与对数：
    - sqrt(x)（平方根）
    - log(x, base)（对数，base 默认为 e）。
- 三角函数：
    - sin(x)
    - cos(x)
    - 以及弧度与角度转换函数
        - degrees(x)  
        - radians(x)  
- 常量：
    - math.pi (π)
    - math.e (e)

#### 1.2.3. string模块

字符串常量与操作  

- 常用常量：
    - digits (0-9)
    - ascii_letters (所有字母)
    - punctuation (标点符号)
- 实战应用：结合 random.choices 和 string 常量可以快速生成随机密码。
- 核心处理方法：
    - 联接：推荐使用 "".join(list) 而非 +，因为 join 效率更高。
    - 分割：split() 默认按空白字符分割，返回列表。
    - 对齐：center()、ljust()、rjust() 用于格式化输出。
    - 查找与检查：find()、index()、startswith()、isdigit() 等。

#### 1.2.4. re模块

正则表达式是处理文本的强大工具，用于分析、提取、替换符合特定“模式”的字符串。

- 元字符 (Meta characters)：
    - 预定义类：`.` (任意字符)、`\d` (数字)、`\s` (空白)、`\w` (字母数字下划线)。
    - 边界：`^` (行首)、`$` (行尾)、`\b` (单词边界)。
    - 重复限定符：`*` (0次或多次)、`+` (1次或多次)、`?` (0次或1次)、`{n,m}` (n到m次)。
- 匹配算法：
    - 贪婪匹配：默认匹配尽可能长的字符串。
    - 懒惰匹配：在限定符后加 `?`，匹配尽可能短的字符串（常用于匹配 HTML/XML 标签）。
- 常用方法：`re.findall()`（返回所有匹配项列表）、`re.sub()`（替换匹配项）、`re.compile()`（编译模式以提高速度）。

### 1.3. 技术文档阅读技巧

- 工具函数：使用 dir(模块) 查看对象列表，使用 help(对象) 查看详细说明。
- 文档结构：区分“入门教程 (Tutorial)”和“API 参考 (Reference)”。
- 策略：善用 Ctrl+F 快速定位，实践代码示例，不理解时参考搜索引擎。

## 2. 课件9：函数

“模块化设计”的重要基础  
重点在于通过函数实现代码的复用、隐藏细节以及提高系统的可维护性  

### 2.1. 函数的基本概念与定义

核心定义：  
函数是一组可重复使用的代码块，通过给定输入（参数）执行特定任务并产生输出（返回值）。

定义五要素：  

1. 关键字 def：函数定义的开始。
2. 函数名：遵循变量命名规范。
3. 形式参数 (形参)：圆括号内的占位符，可以有零个或多个。
4. 函数体：缩进的代码块，实现具体逻辑。
5. 返回值 return：结束函数执行并返回结果。若无 return 或只有 return 后无内容，默认返回 None。

文档字符串 (Docstring)：  
在函数体开头使用三引号编写的注释，可通过 help(函数名) 查看，为用户提供友好的使用说明。  

### 2.2. 参数传递

python的参数系统非常灵活  

- 位置参数：  
    调用时实参与形参的顺序和数量必须严格一致  
- 默认值参数：  
    定义时可以为形参指定默认值  
- 关键词参数：  
    调用时按名称传递值  
    这样可以不按定义顺序传递，增加了灵活性  
- 可变长度参数：  
    - `*args`：接收任意数量的位置参数，作为元组传递给函数。  
    - `**kwargs`：接收任意数量的关键词参数，作为字典传递给函数。
- 赋值传递：  
    在函数调用时，系统会将实参的引用传递给形参，此时形参变量与实参变量指向同一个内存对象。  
    - 传递不可变对象，函数内的修改不会影响外部变量。  
    - 传递可变对象，函数内的修改会影响外部变量。  
    - 避免使用可变对象作为默认值参数，其只会在函数定义时初始化一次，多次调用会共享同一对象。  

注意：为避免歧义，python要求不同类型参数顺序（从左到右）

1. 位置参数
2. 默认值参数
3. 可变长度位置参数  
4. 仅限关键词参数  
5. 可变长度关键词参数  

### 2.3. 变量作用域（Scope）

LEGB规则：  

- Local（局部作用域）：函数内部定义的变量。  
- Enclosing（闭包函数外层作用域）：嵌套函数中，外层函数的变量。  
- Global（全局作用域）：模块级别定义的变量。  
- Built-in（内置作用域）：Python内置模块中的变量和函数。

变量查找顺序：L → E → G → B  

局部变量：在函数内部定义的变量，仅在函数内有效，函数结束后销毁。  

全局变量：再模块级别定义的变量，可在模块内所有函数中访问。  
使用 global 关键字可在函数内声明全局变量。  
函数内如果要更改全局变量的值，必须使用 global 关键字。  

### 2.4. 高阶函数与Lambda表达式

高阶函数：  
可以接收函数作为参数，或者返回一个函数的函数  

常见示例：  

- `map()`：对可迭代对象的每个元素应用指定函数，返回一个迭代器。  
    第一个参数是函数，第二个参数是可迭代对象。  
- `filter()`：根据指定函数的返回值过滤可迭代对象的元素，返回一个迭代器。  
    第一个参数是函数，第二个参数是可迭代对象。  
- `sorted()`：对可迭代对象进行排序，返回一个新的列表。  
    可以自定义排序规则  
    第一个参数是可迭代对象，第二个参数是排序函数。  

Lambda表达式：  
匿名函数  
语法：`lambda 参数列表: 表达式`  
适用于逻辑简单、临时使用的场景  

## 3. 课件10：模块化

模块化思维使得复杂程序更容易维护  

设计方法：  
此处介绍自顶向下设计方法  

### 3.1. 模块化的思想与价值

如果一个代码模块过长，很难维护  
而且难以复用  
总之问题很多  

模块化：  
将大程序模块根据逻辑划分为多个小模块  

高内聚：  
每个模块应该尽量只完成一个功能  

### 3.2. 模块的创建与导入

python中，一个模块就是一个`.py`文件  
文件名就是模块名  

#### 3.2.1. 导入方法

1. `import module_name`：导入整个模块。  
    大型项目中，推荐使用这种方式，避免命名冲突。  
2. `from module_name import function_name`：从模块中导入特定函数。  

实际上和一般的系统模块导入没有区别  

### 3.3. 特殊变量与自测

模块中有特殊变量 `__name__`
它就是模块的名字  

#### 3.3.1. 运行机制

- 直接运行：  
    当模块被直接运行时，`__name__` 的值为 `"__main__"`。  
- 被导入运行：
    当模块被其他模块导入时，`__name__` 的值为模块的实际名称。  

#### 3.3.2. 自测

希望可以在模块内进行测试，但不希望测试代码在模块被导入时执行。  

做法：  

```python
if __name__ == "__main__":
    # 测试代码
    ...
```

这样只有在直接运行模块时，测试代码才会执行。

### 3.4. 自顶向下的模块化设计方法

1. 抽象总目标
2. 划分子模块  
3. 细化子模块

要尽量避免使用全局变量  
函数更加“函数化”  

#### 3.4.1. 多模块调试技巧

可以多使用 `step into` 功能，逐步进入模块内部调试。  
