你是对的，目前的实现是基于**“单向链表”**（每个站点只有一个 prev 和一个 next）构建的，这种简单的结构在面对现实世界复杂的地铁拓扑时确实存在局限性。

问题深度分析
环线问题（如4号线）

现状：目前的 DataLoader 只是简单地把 CSV 里的站点连成一条线。如果 CSV 里 4 号线的数据是 [宜山路, ..., 上海体育馆]，且首尾没有重复出现，那么在程序眼里，这是一条断开的弧形（C形），而不是一个圆（O形）。这意味着从“上海体育馆”去“宜山路”，算法会让你绕行整个上海一圈（或者通过换乘其他线路），而不是直接坐一站。

补救机制：好在我们的系统有“换乘”机制。如果数据源里 4 号线的首尾是同一个站名（例如数据是 宜山路 -> ... -> 宜山路），系统会自动识别它们为“同名换乘”，从而把环闭合。但如果高德数据没给闭环（如你提供的 CSV 样例），环就是断的。

分叉问题（Y型线路，如10号线）

现状：这是最严重的问题。

高德 API 返回的 10 号线数据其实是两条独立的完整路径：

10号线: 基隆路 -> ... -> 虹桥火车站 (主线)

10号线: 基隆路 -> ... -> 航中路 (支线)

Bug 所在：目前的 DataLoader 看到同名的“10号线”，会把第二条线的站点追加到第一条线的末尾。

后果：这会创造一个不存在的虫洞连接 —— 从“虹桥火车站”（主线终点）直接连到了“基隆路”（支线起点）。这会导致路径规划完全错误。

解决方案：利用“虚拟换乘”重构拓扑
我们要用最小的代码改动来完美解决这个问题。核心思路是：将复杂的拓扑结构转化为“多条简单线路 + 换乘连接”。

1. 解决分叉（Y型）：支线独立化
在爬虫阶段（DataFetcher），当我们检测到同一条线路出现了分叉（即同名线路再次出现，且站点序列不同）时，我们不应该强行合并，而应该将支线重命名。

处理逻辑：

第一段数据保持为 10号线。

第二段数据自动重命名为 10号线(支线)。

效果：

系统中会有两条线。

它们在公共部分的站点（如“龙溪路”），因为站名相同，现有的 DataLoader 会自动建立换乘连接。

这样，用户从主线去支线，路径就是：... -> 龙溪路(主) -> [换乘] -> 龙溪路(支) -> ...。

2. 解决环线（O型）：首尾闭合
在爬虫阶段，检测线路的首尾站点。

如果数据源没有闭合（如 4 号线首尾不同），我们需要人工或自动补全。

技巧：在生成 CSV 时，如果判定是环线，强制在末尾再写一行起始站的信息。这样系统就会通过“同名换乘”把环接上。

3. 优化体验：零成本换乘
为了不让用户觉得“同线换乘”很奇怪，我们需要修改核心算法，把这种特殊的换乘代价设为 0。