# Jupyter 插件启动失败

brief：版本太旧，导致与VS Code不兼容，升级Jupyter即可解决问题  

## 原始问题

log.ts:460   ERR Extension 'github.copilot' wants API proposal 'devDeviceId' but that proposal DOES NOT EXIST. Likely, the proposal has been finalized (check 'vscode.d.ts') or was abandoned.

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

（匿名） @ extensionsProposedApi.ts:73

g @ extensionsProposedApi.ts:70

updateEnabledApiProposals @ extensionsProposedApi.ts:60

aAe @ abstractExtensionService.ts:1374

lb @ abstractExtensionService.ts:487

await in lb

kb @ abstractExtensionService.ts:463

await in kb

（匿名） @ nativeExtensionService.ts:140

requestIdleCallback

eG @ async.ts:1464

Uv @ dom.ts:244

（匿名） @ nativeExtensionService.ts:139

Promise.then

gxt @ nativeExtensionService.ts:137

o @ instantiationService.ts:169

x @ instantiationService.ts:302

w @ instantiationService.ts:291

v @ instantiationService.ts:280

u @ instantiationService.ts:213

s @ instantiationService.ts:197

get @ instantiationService.ts:102

（匿名） @ workbench.ts:138

invokeFunction @ instantiationService.ts:116

startup @ workbench.ts:133

open @ desktop.main.ts:137

await in open

_fn @ desktop.main.ts:421

（匿名） @ workbench.ts:532

await in （匿名）

（匿名） @ workbench.ts:533

log.ts:460   ERR Extension 'ms-python.vscode-python-envs' appears in product.json but enables LESS API proposals than the extension wants.

package.json (LOSES): terminalShellEnv, terminalDataWriteEvent

product.json (WINS): terminalShellEnv

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

g @ extensionsProposedApi.ts:92

updateEnabledApiProposals @ extensionsProposedApi.ts:60

aAe @ abstractExtensionService.ts:1374

lb @ abstractExtensionService.ts:487

await in lb

kb @ abstractExtensionService.ts:463

await in kb

（匿名） @ nativeExtensionService.ts:140

requestIdleCallback

eG @ async.ts:1464

Uv @ dom.ts:244

（匿名） @ nativeExtensionService.ts:139

Promise.then

gxt @ nativeExtensionService.ts:137

o @ instantiationService.ts:169

x @ instantiationService.ts:302

w @ instantiationService.ts:291

v @ instantiationService.ts:280

u @ instantiationService.ts:213

s @ instantiationService.ts:197

get @ instantiationService.ts:102

（匿名） @ workbench.ts:138

invokeFunction @ instantiationService.ts:116

startup @ workbench.ts:133

open @ desktop.main.ts:137

await in open

_fn @ desktop.main.ts:421

（匿名） @ workbench.ts:532

await in （匿名）

（匿名） @ workbench.ts:533

log.ts:460   ERR Extension 'ms-toolsai.jupyter' wants API proposal 'notebookCellExecutionState' but that proposal DOES NOT EXIST. Likely, the proposal has been finalized (check 'vscode.d.ts') or was abandoned.

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

（匿名） @ extensionsProposedApi.ts:73

g @ extensionsProposedApi.ts:70

updateEnabledApiProposals @ extensionsProposedApi.ts:60

aAe @ abstractExtensionService.ts:1374

lb @ abstractExtensionService.ts:487

await in lb

kb @ abstractExtensionService.ts:463

await in kb

（匿名） @ nativeExtensionService.ts:140

requestIdleCallback

eG @ async.ts:1464

Uv @ dom.ts:244

（匿名） @ nativeExtensionService.ts:139

Promise.then

gxt @ nativeExtensionService.ts:137

o @ instantiationService.ts:169

x @ instantiationService.ts:302

w @ instantiationService.ts:291

v @ instantiationService.ts:280

u @ instantiationService.ts:213

s @ instantiationService.ts:197

get @ instantiationService.ts:102

（匿名） @ workbench.ts:138

invokeFunction @ instantiationService.ts:116

startup @ workbench.ts:133

open @ desktop.main.ts:137

await in open

_fn @ desktop.main.ts:421

（匿名） @ workbench.ts:532

await in （匿名）

（匿名） @ workbench.ts:533

log.ts:460   ERR [Extension Host] (node:29264) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.

(Use `Code --trace-deprecation ...` to show where the warning was created)

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

kvs @ remoteConsoleUtil.ts:58

$logExtensionHostMessage @ mainThreadConsole.ts:38

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

console.ts:137 [Extension Host] (node:29264) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.

(Use `Code --trace-deprecation ...` to show where the warning was created)

Cvs @ console.ts:137

$logExtensionHostMessage @ mainThreadConsole.ts:39

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

notificationsAlerts.ts:42 扩展激活失败，有关详细信息，请运行 'Developer: Toggle Developer Tools' 命令。

c @ notificationsAlerts.ts:42

（匿名） @ notificationsAlerts.ts:28

C @ event.ts:1201

D @ event.ts:1212

fire @ event.ts:1236

addNotification @ notifications.ts:228

notify @ notificationService.ts:234

（匿名） @ mainThreadMessageService.ts:93

g @ mainThreadMessageService.ts:56

$showMessage @ mainThreadMessageService.ts:50

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

log.ts:460   ERR [Extension Host] extension activation failed TypeError: this.vscNotebook.onDidChangeNotebookCellExecutionState is not a function

at new Rk (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:24:501992)

at f (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:544315)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546205

at t.resolveInstance (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546232)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549264

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549601

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548924

at v (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548956)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548818

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548752

at Array.map (<anonymous>)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548724

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545563

at Array.reduce (<anonymous>)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545535

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545862

at t.resolveInstance (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546232)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549264

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549601

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548924

at v (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548956)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548818

at t.resolve (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:550788)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519761

at e._get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519130)

at e._getButThrowIfAsync (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519190)

at e.get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:514885)

at up.get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:17:36027)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:24:650173

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

kvs @ remoteConsoleUtil.ts:58

$logExtensionHostMessage @ mainThreadConsole.ts:38

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

console.ts:137 [Extension Host] extension activation failed TypeError: this.vscNotebook.onDidChangeNotebookCellExecutionState is not a function

at new Rk (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:24:501992)

at f (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:544315)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546205

at t.resolveInstance (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546232)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549264

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549601

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548924

at v (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548956)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548818

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548752

at Array.map (<anonymous>)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548724

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545563

at Array.reduce (<anonymous>)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545535

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545862

at t.resolveInstance (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546232)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549264

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549601

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548924

at v (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548956)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548818

at t.resolve (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:550788)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519761

at e._get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519130)

at e._getButThrowIfAsync (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519190)

at e.get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:514885)

at up.get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:17:36027)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:24:650173

Cvs @ console.ts:137

$logExtensionHostMessage @ mainThreadConsole.ts:39

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

mainThreadExtensionService.ts:78 [ms-toolsai.jupyter]this.vscNotebook.onDidChangeNotebookCellExecutionState is not a function

$onExtensionRuntimeError @ mainThreadExtensionService.ts:78

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

mainThreadExtensionService.ts:79 TypeError: this.vscNotebook.onDidChangeNotebookCellExecutionState is not a function

at new Rk (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:24:501992)

at f (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:544315)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546205

at t.resolveInstance (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546232)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549264

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549601

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548924

at v (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548956)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548818

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548752

at Array.map (<anonymous>)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548724

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545563

at Array.reduce (<anonymous>)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545535

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:545862

at t.resolveInstance (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:546232)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549264

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:549601

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548924

at v (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548956)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:548818

at t.resolve (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:550788)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519761

at e._get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519130)

at e._getButThrowIfAsync (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:519190)

at e.get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:2:514885)

at up.get (D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:17:36027)

at D:\_WorkingApps\Microsoft VS Code Extensions\extensions\ms-toolsai.jupyter-2023.8.1002501831\out\extension.node.js:24:650173

$onExtensionRuntimeError @ mainThreadExtensionService.ts:79

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

log.ts:460   ERR 出现未知错误。有关详细信息，请参阅日志。

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

oc @ workbench.ts:121

（匿名） @ workbench.ts:102

onUnexpectedError @ errors.ts:65

bt @ errors.ts:110

$onUnexpectedError @ mainThreadErrors.ts:21

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

log.ts:460   ERR [Extension Host] (node:29264) ExperimentalWarning: SQLite is an experimental feature and might change at any time

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

kvs @ remoteConsoleUtil.ts:58

$logExtensionHostMessage @ mainThreadConsole.ts:38

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

console.ts:137 [Extension Host] (node:29264) ExperimentalWarning: SQLite is an experimental feature and might change at any time

Cvs @ console.ts:137

$logExtensionHostMessage @ mainThreadConsole.ts:39

S @ rpcProtocol.ts:458

Q @ rpcProtocol.ts:443

M @ rpcProtocol.ts:373

L @ rpcProtocol.ts:299

（匿名） @ rpcProtocol.ts:161

C @ event.ts:1201

fire @ event.ts:1232

fire @ ipc.net.ts:652

l.onmessage @ localProcessExtensionHost.ts:383

log.ts:460   ERR Collection or definition not found for ms-python.vscode-pylance/pylanceMcp and ms-python.vscode-pylance/pylance mcp server: Error: Collection or definition not found for ms-python.vscode-pylance/pylanceMcp and ms-python.vscode-pylance/pylance mcp server

    at lht.resolveConnection (vscode-file://vscode-app/d:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/vs/workbench/workbench.desktop.main.js:2160:2100)

    at vscode-file://vscode-app/d:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/vs/workbench/workbench.desktop.main.js:2160:11387

    at vscode-file://vscode-app/d:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/vs/workbench/workbench.desktop.main.js:30:73168

error @ log.ts:460

error @ log.ts:565

error @ logService.ts:51

oc @ workbench.ts:121

（匿名） @ workbench.ts:102

onUnexpectedError @ errors.ts:65

bt @ errors.ts:110

（匿名） @ workbench.ts:95

log.ts:460   ERR [UriError]: Scheme contains illegal characters.: Error: [UriError]: Scheme contains illegal characters.

    at z6 (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:64298)

    at new od (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:67678)

    at new zr (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:69116)

    at od.revive (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:68893)

    at o5.call (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:88:105741)

    at Lf.s (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:31:14859)

    at Lf.q (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:31:14382)

    at Xo.value (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:31:13784)

    at P.C (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2373)

    at P.D (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2443)

    at P.fire (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2660)

    at Xo.value (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:28:4922)

    at P.C (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2373)

    at P.fire (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2591)

    at Xo.value (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:28:5110)

    at P.C (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2373)

    at P.fire (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:30:2591)

    at N (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:28:7404)

    at IpcMainImpl.i (file:///D:/_WorkingApps/Microsoft%20VS%20Code/resources/app/out/main.js:36:10776)

    at IpcMainImpl.emit (node:events:518:28)

    at Session.<anonymous> (node:electron/js2c/browser_init:2:106370)

    at Session.emit (node:events:518:28)

## AI分析

根据你提供的详细错误日志，你的 VS Code 中 Jupyter 拓展启动失败的核心原因是 **VS Code 软件本体与 Jupyter 拓展版本之间存在严重的不兼容**。

具体来说，你的环境似乎处于一种“新旧混杂”或“过旧”的状态，导致代码试图调用不存在的接口。

### 错误分析

从日志中可以定位到两个关键的致命错误：

1. **API 提案丢失 (API Proposal Missing):**
> `ERR Extension 'ms-toolsai.jupyter' wants API proposal 'notebookCellExecutionState' but that proposal DOES NOT EXIST.`


这意味着你安装的 Jupyter 拓展试图使用一个名为 `notebookCellExecutionState` 的测试版 API 功能，但你当前的 VS Code 核心并不支持它（可能该功能已在旧版本中被移除，或者你的 VS Code 版本太旧不支持该新功能）。
2. **核心函数调用失败 (Function Not Found):**
> `TypeError: this.vscNotebook.onDidChangeNotebookCellExecutionState is not a function`


这是导致崩溃的直接原因。Jupyter 拓展的代码里调用了 `onDidChangeNotebookCellExecutionState`，但 VS Code 告诉它“没有这个功能”。

**注意到了吗？** 日志显示你的 Jupyter 版本是 `2023.8.1002501831`（2023 年 8 月的版本）。如果你现在的系统时间是 2026 年，或者你的 VS Code 本体已经更新到了较新版本，那么**在新的 VS Code 上运行一个 2023 年的老旧拓展**极大概率会因为 API 变动而报错。旧拓展还在寻找当年的“实验性接口”，而这些接口在现代 VS Code 中早已变更为正式接口或被废弃。

---

### 解决方案

请按照以下步骤依次尝试，通常第一步就能解决问题。

#### 方法一：更新或重装 Jupyter 拓展（最推荐）

由于日志显示你正在使用的是 2023 年的旧版本拓展，首先需要将其更新到与你当前 VS Code 匹配的最新版。

1. 打开 VS Code。
2. 点击左侧边栏的 **Extensions（拓展）** 图标（方块积木形状）。
3. 在搜索框输入 `Jupyter`。
4. 找到 **Jupyter (Microsoft)**，如果显示有 **Update（更新）** 按钮，请立即点击更新。
5. **如果已经是最新版或更新失败**：
* 点击拓展名称旁边的**齿轮图标** -> **Uninstall（卸载）**。
* **重启 VS Code**（这一步很重要，确保旧文件释放）。
* 再次搜索 `Jupyter` 并点击 **Install（安装）**。



#### 方法二：更新 VS Code 软件本体

如果你的拓展更新后依然报错，说明你的 VS Code 软件本体可能太旧了，无法支持新版拓展所需的 API。

1. 在 VS Code 顶部菜单栏点击 **Help (帮助)**。
2. 点击 **Check for Updates (检查更新)**。
3. 如果有更新，请下载并安装，然后重启 VS Code。

#### 方法三：暴力清理缓存（如果上述方法无效）

日志中显示你的拓展安装路径在 `D:\_WorkingApps\Microsoft VS Code Extensions\`。有时候更新不彻底，旧的缓存文件会残留导致持续报错。

1. 关闭 VS Code。
2. 打开文件资源管理器，进入日志中显示的路径：
`D:\_WorkingApps\Microsoft VS Code Extensions\extensions\`
3. 找到并**删除**以 `ms-toolsai.jupyter` 开头的所有文件夹（例如 `ms-toolsai.jupyter-2023.8.1002501831`）。
4. 同时，建议删除 `ms-python.python` 相关的文件夹，以确保 Python 环境纯净。
5. 重启 VS Code，它会提示你重新安装这些拓展，此时它会拉取最适配的版本。

### 总结

你的问题大概率是因为**拓展版本过旧（2023版）**与当前的 VS Code 环境不匹配。执行**方法一（重装拓展）**通常能直接解决问题。

需要我协助你检查 Python 环境配置吗？
